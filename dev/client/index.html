<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Client · Discord.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="Discord.jl logo"/></a><h1>Discord.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li class="current"><a class="toctext" href>Client</a><ul class="internal"><li><a class="toctext" href="#Gateway-1">Gateway</a></li><li><a class="toctext" href="#Event-Handlers-1">Event Handlers</a></li><li><a class="toctext" href="#Bot-Commands-1">Bot Commands</a></li><li><a class="toctext" href="#Caching-1">Caching</a></li></ul></li><li><a class="toctext" href="../events/">Events</a></li><li><a class="toctext" href="../rest/">REST API</a></li><li><a class="toctext" href="../helpers/">Helpers</a></li><li><a class="toctext" href="../types/">Types</a></li><li><a class="toctext" href="../tutorial/">Tutorial</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Client</a></li></ul><a class="edit-page" href="https://github.com/PurgePJ/Discord.jl/blob/master/docs/src/client.md#L"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Client</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Client-1" href="#Client-1">Client</a></h1><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.Client" href="#Discord.Client"><code>Discord.Client</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">Client(
    token::String;
    prefix::String=&quot;&quot;,
    presence::Union{Dict, NamedTuple}=Dict(),
    strategies::Dict{DataType, &lt;:CacheStrategy}=Dict(),
    version::Int=6,
) -&gt; Client</code></pre><p>A Discord bot. <code>Client</code>s can connect to the gateway, respond to events, and make REST API calls to perform actions such as sending/deleting messages, kicking/banning users, etc.</p><p><strong>Bot Token</strong></p><p>A bot token can be acquired by creating a new application <a href="https://discordapp.com/developers/applications">here</a>. Make sure not to hardcode the token into your Julia code! Use an environment variable or configuration file instead.</p><p><strong>Command Prefix</strong></p><p>The <code>prefix</code> keyword specifies the command prefix, which is used by commands added with <a href="#Discord.add_command!"><code>add_command!</code></a>. It can be changed later, both globally and on a per-guild basis, with <a href="#Discord.set_prefix!"><code>set_prefix!</code></a>.</p><p><strong>Presence</strong></p><p>The <code>presence</code> keyword sets the bot&#39;s presence upon connection. It also sets defaults for future calls to <a href="../helpers/#Discord.set_game"><code>set_game</code></a>. The schema <a href="https://discordapp.com/developers/docs/topics/gateway#update-status-gateway-status-update-structure">here</a> must be followed.</p><p><strong>Cache Control</strong></p><p>By default, most data that comes from Discord is cached for later use. However, to avoid memory leakage, not all of it is kept forever. The default setings are to keep everything but <a href="../types/#Discord.Message"><code>Message</code></a>s, which are deleted after 6 hours, forever. Although the default settings are sufficient for most workloads, you can specify your own strategies per type with the <code>strategies</code> keyword. Keys can be any of the following:</p><ul><li><a href="../types/#Discord.Guild"><code>Guild</code></a></li><li><a href="../types/#Discord.DiscordChannel"><code>DiscordChannel</code></a></li><li><a href="../types/#Discord.Message"><code>Message</code></a></li><li><a href="../types/#Discord.User"><code>User</code></a></li><li><a href="../types/#Discord.Member"><code>Member</code></a></li><li><a href="../types/#Discord.Presence"><code>Presence</code></a></li></ul><p>For potential values, see <a href="#Discord.CacheStrategy"><code>CacheStrategy</code></a>.</p><p>The cache can also be disabled/enabled permanently and temporarily as a whole with <a href="#Discord.enable_cache!"><code>enable_cache!</code></a> and <a href="#Discord.disable_cache!"><code>disable_cache!</code></a>.</p><p><strong>API Version</strong></p><p>The <code>version</code> keyword chooses the Version of the Discord API to use. Using anything but <code>6</code> is not officially supported by the Discord.jl developers.</p><p><strong>Sharding</strong></p><p>Sharding is handled automatically. The number of available processes is the number of shards that are created. See the <a href="https://github.com/PurgePJ/Discord.jl/blob/master/examples/sharding.jl">sharding example</a> for more details.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/client/client.jl#LL34-L90">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.enable_cache!" href="#Discord.enable_cache!"><code>Discord.enable_cache!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">enable_cache!(c::Client)
enable_cache!(f::Function c::Client)</code></pre><p>Enable the cache. <code>do</code> syntax is also accepted.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/client/client.jl#LL169-L174">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.disable_cache!" href="#Discord.disable_cache!"><code>Discord.disable_cache!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">disable_cache!(c::Client)
disable_cache!(f::Function, c::Client)</code></pre><p>Disable the cache. <code>do</code> syntax is also accepted.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/client/client.jl#LL178-L183">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.me" href="#Discord.me"><code>Discord.me</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">me(c::Client) -&gt; Nullable{User}</code></pre><p>Get the <a href="#Discord.Client"><code>Client</code></a>&#39;s bot user.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/client/client.jl#LL162-L166">source</a></section><h2><a class="nav-anchor" id="Gateway-1" href="#Gateway-1">Gateway</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.open" href="#Base.open"><code>Base.open</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">open(c::Client; delay::Period=Second(7))</code></pre><p>Connect a <a href="#Discord.Client"><code>Client</code></a> to the Discord gateway.</p><p>The <code>delay</code> keyword is the time between shards connecting. It can be increased from its default if you are using multiple shards and frequently experiencing invalid sessions upon  connection.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/gateway/gateway.jl#LL30-L38">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.isopen" href="#Base.isopen"><code>Base.isopen</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">isopen(c::Client) -&gt; Bool</code></pre><p>Determine whether the <a href="#Discord.Client"><code>Client</code></a> is connected to the gateway.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/gateway/gateway.jl#LL106-L110">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.close" href="#Base.close"><code>Base.close</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">close(c::Client)</code></pre><p>Disconnect the <a href="#Discord.Client"><code>Client</code></a> from the gateway.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/gateway/gateway.jl#LL113-L117">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.wait" href="#Base.wait"><code>Base.wait</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">wait(c::Client)</code></pre><p>Wait for an open <a href="#Discord.Client"><code>Client</code></a> to close.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/gateway/gateway.jl#LL131-L135">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.request_guild_members" href="#Discord.request_guild_members"><code>Discord.request_guild_members</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">request_guild_members(
    c::Client,
    guilds::Union{Integer, Vector{&lt;:Integer};
    query::AbstractString=&quot;&quot;,
    limit::Int=0,
) -&gt; Bool</code></pre><p>Request offline guild members of one or more <a href="../types/#Discord.Guild"><code>Guild</code></a>s. <a href="../events/#Discord.GuildMembersChunk"><code>GuildMembersChunk</code></a> events are sent by the gateway in response. More details <a href="https://discordapp.com/developers/docs/topics/gateway#request-guild-members">here</a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/gateway/gateway.jl#LL147-L158">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.update_voice_state" href="#Discord.update_voice_state"><code>Discord.update_voice_state</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">update_voice_state(
    c::Client,
    guild::Integer,
    channel::Nullable{Integer},
    mute::Bool,
    deaf::Bool,
) -&gt; Bool</code></pre><p>Join, move, or disconnect from a voice channel. A <a href="../events/#Discord.VoiceStateUpdate"><code>VoiceStateUpdate</code></a> event is sent by the gateway in response. More details <a href="https://discordapp.com/developers/docs/topics/gateway#update-voice-state">here</a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/gateway/gateway.jl#LL183-L195">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.update_status" href="#Discord.update_status"><code>Discord.update_status</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">update_status(
    c::Client,
    since::Nullable{Int},
    activity::Nullable{Activity},
    status::Union{PresenceStatus, AbstractString},
    afk::Bool,
) -&gt; Bool</code></pre><p>Indicate a presence or status update. A <a href="../events/#Discord.PresenceUpdate"><code>PresenceUpdate</code></a> event is sent by the gateway in response. More details <a href="https://discordapp.com/developers/docs/topics/gateway#update-status">here</a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/gateway/gateway.jl#LL213-L225">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.heartbeat_ping" href="#Discord.heartbeat_ping"><code>Discord.heartbeat_ping</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">heartbeat_ping(c::Client) -&gt; Nullable{Period}</code></pre><p>Get the <a href="#Discord.Client"><code>Client</code></a>&#39;s ping time to the gateway. If the client is not connected, or no heartbeats have been sent/acknowledged, <code>nothing</code> is returned.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/utils/helpers.jl#LL279-L284">source</a></section><h2><a class="nav-anchor" id="Event-Handlers-1" href="#Event-Handlers-1">Event Handlers</a></h2><p>See <a href="../events/#Events-1">Events</a> for more details.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.add_handler!" href="#Discord.add_handler!"><code>Discord.add_handler!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">add_handler!(
    c::Client,
    [T::Type{&lt;:AbstractEvent}],
    handler::Function;
    tag::Symbol=gensym(),
    predicate::Function=alwaystrue,
    fallback::Function=donothing,
    priority::Int=100,
    count::Nullable{Int}=nothing,
    timeout::Nullable{Period}=nothing,
    until::Function=alwaysfalse,
    wait::Bool=false,
    compile::Bool=false,
    kwargs...,
) -&gt; Nullable{Vector{Any}}</code></pre><p>Add an event handler. <code>do</code> syntax is also accepted.</p><p><strong>Handler Function</strong></p><p>The handler function does the real work and must take two arguments: A <a href="#Discord.Client"><code>Client</code></a> and an <a href="../events/#Discord.AbstractEvent"><code>AbstractEvent</code></a> (or a subtype). If an event type <code>T</code> is supplied, then the handler is registered for that event. Otherwise, the second argument of the handler must be annotated, and the type annotation determines what events will invoke the handler. <code>Union</code> types are also accepted to register handlers for multiple events.</p><p><strong>Handler Tag</strong></p><p>The <code>tag</code> keyword gives a label to the handler, which can be used to remove it with <a href="#Discord.delete_handler!"><code>delete_handler!</code></a>.</p><p><strong>Predicate/Fallback Functions</strong></p><p>The <code>predicate</code> keyword specifies a predicate function. The handler will only run if this function returns <code>true</code>. Otherwise, a fallback function, specified by the <code>fallback</code> keyword, is run. Their signatures should match that of the handler.</p><p><strong>Handler Priority</strong></p><p>The <code>priority</code> keyword indicates the handler&#39;s priority relative to other handlers for the same event. Handlers with higher values execute before those with lower ones.</p><p><strong>Handler Expiry</strong></p><p>Handlers can have multiple types of expiries. The <code>count</code> keyword sets the number of times a handler is run before expiring. The <code>timeout</code> keyword determines how long the handler remains active. The <code>until</code> keyword takes a function which is called on the handler&#39;s previous results (in a <code>Vector</code>), and if it returns <code>true</code>, the handler expires. These keywords can be combined; the first condition to be met causes the handler to expire.</p><p><strong>Blocking Handlers + Result Collection</strong></p><p>To collect results from a handler, set the <code>wait</code> keyword along with <code>n</code>, <code>timeout</code>, and/or <code>until</code>. The call will block until the handler expires, at which point the return value of each invocation is returned in a <code>Vector</code>.</p><p><strong>Forcing Precompilation</strong></p><p>Handler functions are precompiled without running them, but it&#39;s not always successful, especially if your functions are not type-safe. If the <code>compile</code> keyword is set, precompilation is forced by running the predicate and handler on a randomized input. Any trailing keywords are passed to the constructors of the event and its fields.</p><p><strong>Examples</strong></p><p>Basic &quot;hello world&quot; with explicit event type:</p><pre><code class="language-julia">add_handler!(c, MessageCreate, (c, e) -&gt; println(e.message.content); tag=:print)</code></pre><p>Adding a handler with a predicate and fallback:</p><pre><code class="language-julia">handler(::Client, e::ChannelCreate) = println(e.channel.name)
predicate(::Client, e::ChannelCreate) = length(e.channel.name) &lt; 10
fallback(::Client, ::ChannelCreate) = println(&quot;channel name too long&quot;)
add_handler!(c, handler; predicate=predicate, fallback=fallback)</code></pre><p>Assigning maximum priority to a handler:</p><pre><code class="language-julia">handler(:::Client, ::MessageCreate) = println(&quot;this runs before any other handlers!&quot;)
add_handler!(c, handler; priority=typemax(Int))</code></pre><p>Adding a handler with various expiry conditions:</p><pre><code class="language-julia">handler(::Client, e::ChannelCreate) = e.channel.name
until(results::Vector{Any}) = &quot;foo&quot; in results
add_handler!(c, handler; count=10, timeout=Minute(1), until=until)</code></pre><p>Aggregating results of a handler:</p><pre><code class="language-julia">handler(::Client, e::MessageCreate) = e.message.content
msgs = add_handler!(c, handler; count=5, wait=true)</code></pre><p>Forcing precompilation:</p><pre><code class="language-julia">handler(::Client, e::MessageDelete) = @show e
add_handler!(c, handler; compile=true, id=0xff)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/client/client.jl#LL187-L277">source</a><div><div><pre><code class="language-none">add_handler!(c::Client, m::Module; kwargs...)</code></pre><p>Add all of the event handlers defined in a module. Any function you wish to use as a handler must be exported. Only functions with correct, annotated type signatures (see above) are used.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>If you set keywords, they are applied to all of the handlers in the module. For example, if you add two handlers for the same event type with the same tag, one of them will be immediately overwritten.</p></div></div></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/client/client.jl#LL373-L384">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.delete_handler!" href="#Discord.delete_handler!"><code>Discord.delete_handler!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">delete_handler!(c::Client, T::Type{&lt;:AbstractEvent}, tag::Symbol)
delete_handler!(c::Client, T::Type{&lt;:AbstractEvent})</code></pre><p>Delete event handlers. If no <code>tag</code> is supplied, all handlers for the event are deleted. Using the tagless method is generally not recommended because it also clears default handlers which maintain the client state. If you do want to delete a default handler, use <a href="#Discord.DEFAULT_HANDLER_TAG"><code>DEFAULT_HANDLER_TAG</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/client/client.jl#LL396-L404">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.DEFAULT_HANDLER_TAG" href="#Discord.DEFAULT_HANDLER_TAG"><code>Discord.DEFAULT_HANDLER_TAG</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><p>Tag assigned to default handlers, which you can use to delete them.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/client/client.jl#LL13-L15">source</a></section><h2><a class="nav-anchor" id="Bot-Commands-1" href="#Bot-Commands-1">Bot Commands</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.add_command!" href="#Discord.add_command!"><code>Discord.add_command!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">add_command!(
    c::Client,
    name::Symbol,
    handler::Function;
    help::AbstractString=&quot;&quot;,
    parsers::Vector=[],
    separator::StringOrChar=&#39; &#39;,
    pattern::Regex=defaultpattern(name, length(parsers), separator),
    allowed::Vector{&lt;:Integer}=Snowflake[],
    permissions::Integer=PERM_NONE,
    cooldown::Nullable{Period}=nothing,
    fallback_parsers::Function=donothing,
    fallback_allowed::Function=donothing,
    fallback_permissions::Function=donothing,
    fallback_cooldown::Function=donothing,
    priority::Int=100,
    count::Nullable{Int}=nothing,
    timeout::Nullable{Period}=nothing,
    compile::Bool=false,
    kwargs...,
)</code></pre><p>Add a text command handler. <code>do</code> syntax is also accepted.</p><p><strong>Handler Function</strong></p><p>The handler function must accept a <a href="#Discord.Client"><code>Client</code></a> and a <a href="../types/#Discord.Message"><code>Message</code></a>. Additionally, it can accept any number of additional arguments, which are captured from <code>pattern</code> and parsed with <code>parsers</code> (see below).</p><p><strong>Command Pattern</strong></p><p>The <code>pattern</code> keyword specifies how to invoke the command. The given <code>Regex</code> must match the message contents after having removed the command prefix. By default, it&#39;s the command name with as many wildcard capture groups as there are parsers, separated by the <code>separator</code> keyword (a space character by default).</p><p><strong>Command Help</strong></p><p>The <code>help</code> keyword specifies a help string which can be used by <a href="#Discord.add_help!"><code>add_help!</code></a>.</p><p><strong>Argument Parsing</strong></p><p>The <code>parsers</code> keyword sets the parsers of the command arguments, and can contain both types and functions. If <code>pattern</code> contains captures, then they are run through the parsers before being passed into the handler. For repeating arguments, see <a href="#Discord.Splat"><code>Splat</code></a>.</p><p><strong>Authorization + Required Permissions</strong></p><p>The <code>allowed</code> keyword specifies <a href="../types/#Discord.User"><code>User</code></a>s or <a href="../types/#Discord.Role"><code>Role</code></a>s (by ID) that are allowed to use the command. The <code>permissions</code> keyword sets the minimum permissions that command callers must have.</p><p><strong>Rate Limiting</strong></p><p>The <code>cooldown</code> keyword sets the rate at which a user can invoke the command. The default of <code>nothing</code> indicates no limit.</p><p><strong>Fallback Functions</strong></p><p>The <code>fallback_*</code> keywords specify functions to be run whenever a command is called but cannot be run, such as failed argument parsing, missing permissions, or rate limiting. They should accept a <a href="#Discord.Client"><code>Client</code></a> and a <a href="../types/#Discord.Message"><code>Message</code></a>.</p><p>Additional keyword arguments are a subset of those to <a href="#Discord.add_handler!"><code>add_handler!</code></a>.</p><p><strong>Examples</strong></p><p>Basic echo command with a help string:</p><pre><code class="language-julia">add_command!(c, :echo, (c, m) -&gt; reply(c, m, m.content); help=&quot;repeat a message&quot;)</code></pre><p>The same, but excluding the command part:</p><pre><code class="language-julia">add_command!(c, :echo, (c, m, msg) -&gt; reply(c, m, msg); pattern=r&quot;^echo (.+)&quot;)</code></pre><p>Parsing a subtraction expression with custom parsers and separator:</p><pre><code class="language-julia">add_command!(
    c, :sub, (c, m, a, b) -&gt; reply(c, m, string(a - b));
    parsers=[Float64, Float64], separator=&#39;-&#39;,
)</code></pre><p>Splatting some comma-separated numbers with a parsing fallback function:</p><pre><code class="language-julia">add_command!(
    c, :sum, (c, m, xs...) -&gt; reply(c, m, string(sum(collect(xs))));
    parsers=[Splat(Float64, &#39;,&#39;)],
    fallback_parsers=(c, m) -&gt; reply(c, m, &quot;Args must be numbers.&quot;),
)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/utils/commands.jl#LL215-L299">source</a><div><div><pre><code class="language-none">add_command!(c::Client, m::Module; compile::Bool=false; kwargs...)</code></pre><p>Add all of the bot commands defined in a module. To set up commands to be included, see <a href="#Discord.@command"><code>@command</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/utils/commands.jl#LL333-L338">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.@command" href="#Discord.@command"><code>Discord.@command</code></a> — <span class="docstring-category">Macro</span>.</div><div><div><pre><code class="language-none">@command name=name handler=handler kwargs...</code></pre><p>Mark a function as a bot command to be collected by <a href="#Discord.add_command!"><code>add_command!</code></a> (from a module). Supported keywords are identical to <code>add_command!</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia">module Commands
using Discord
echo(c::Client, m::Message, noprefix::AbstractString) = reply(c, m, noprefix)
@command name=:echo handler=echo help=&quot;Echo a message&quot; pattern=r&quot;^echo (.+)&quot;
end
c = Client(&quot;token&quot;)
add_command!(c, Commands)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/utils/commands.jl#LL158-L174">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.delete_command!" href="#Discord.delete_command!"><code>Discord.delete_command!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">delete_command!(c::Client, name::Symbol)</code></pre><p>Delete a command.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/utils/commands.jl#LL345-L349">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.add_help!" href="#Discord.add_help!"><code>Discord.add_help!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">add_help!(
    c::Client;
    pattern::Regex=r&quot;^help(?: (.+))?&quot;,
    help::AbstractString=&quot;Show this help message&quot;,
    nohelp::AbstractString=&quot;No help provided&quot;,
    nocmd::AbstractString=&quot;Command not found&quot;,
)</code></pre><p>Add a help command. This can be called at any time, new commands will be included automatically.</p><p><strong>Keywords</strong></p><ul><li><code>separator::StringOrChar</code>: Separator between commands.</li><li><code>pattern::Regex</code>: The command pattern (see <a href="#Discord.add_command!"><code>add_command!</code></a>).</li><li><code>help::AbstractString</code>: Help for the help command.</li><li><code>nohelp::AbstractString</code>: Help for commands without their own help string.</li><li><code>nocmd::AbstractString</code>: Help for commands that aren&#39;t found.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/utils/commands.jl#LL352-L370">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.set_prefix!" href="#Discord.set_prefix!"><code>Discord.set_prefix!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">set_prefix!(c::Client, prefix::StringOrChar)
set_prefix!(c::Client, prefix::StringOrChar, guild::Union{Guild, Integer})</code></pre><p>Set <a href="#Discord.Client"><code>Client</code></a>&#39;s command prefix. If a <a href="../types/#Discord.Guild"><code>Guild</code></a> or its ID is supplied, then the prefix only applies to that guild.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/utils/commands.jl#LL412-L418">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.Splat" href="#Discord.Splat"><code>Discord.Splat</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">Splat(func::Base.Callable=identity, split::StringOrChar=&#39; &#39;) -&gt; Splat</code></pre><p>Collect a variable number of arguments from one capture group with a single parser.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/utils/commands.jl#LL182-L186">source</a></section><h2><a class="nav-anchor" id="Caching-1" href="#Caching-1">Caching</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.CacheStrategy" href="#Discord.CacheStrategy"><code>Discord.CacheStrategy</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>A method of handling cache insertion and eviction.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/client/state.jl#LL9-L11">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.CacheForever" href="#Discord.CacheForever"><code>Discord.CacheForever</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">CacheForever() -&gt; CacheForever</code></pre><p>Store everything and never evict items from the cache.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/client/state.jl#LL14-L18">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.CacheNever" href="#Discord.CacheNever"><code>Discord.CacheNever</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">CacheNever() -&gt; CacheNever</code></pre><p>Don&#39;t store anything in the cache.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/client/state.jl#LL21-L25">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.CacheTTL" href="#Discord.CacheTTL"><code>Discord.CacheTTL</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">CacheTTL(ttl::Period) -&gt; CacheTTL</code></pre><p>Evict items from the cache after <code>ttl</code> has elapsed.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/client/state.jl#LL28-L32">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.CacheLRU" href="#Discord.CacheLRU"><code>Discord.CacheLRU</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">CacheLRU(size::Int) -&gt; CacheLRU</code></pre><p>Evict the least recently used item from the cache when there are more than <code>size</code> items.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/client/state.jl#LL37-L41">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Discord.CacheFilter" href="#Discord.CacheFilter"><code>Discord.CacheFilter</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">CacheFilter(f::Function) -&gt; CacheFilter</code></pre><p>Only store value <code>v</code> at key <code>k</code> if <code>f(v) === true</code> (<code>k</code> is always <code>v.id</code>).</p></div></div><a class="source-link" target="_blank" href="https://github.com/PurgePJ/Discord.jl/blob/4f414e75dc2696230dd6f2917bebb05dc096c4d6/src/client/state.jl#LL46-L50">source</a></section><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="../events/"><span class="direction">Next</span><span class="title">Events</span></a></footer></article></body></html>
